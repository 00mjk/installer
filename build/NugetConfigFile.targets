<Project ToolsVersion="15.0">
  <Target Name="WriteNugetConfigFile">

    <PropertyGroup>
      <NugetConfigHeader>
        &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
        &lt;configuration&gt;
        &lt;packageSources&gt;
        &lt;!--To inherit the global NuGet package sources remove the &lt;clear/&gt; line below --&gt;
        &lt;clear /&gt;
      </NugetConfigHeader>

      <NugetConfigFeedsPrivate>
        &lt;add key=&quot;PrivateBlobFeed&quot; value=&quot;$(ExternalRestoreSources)&quot; /&gt;
      </NugetConfigFeedsPrivate>
      
      <NugetConfigFeedsNormal>
        &lt;add key=&quot;BlobFeed&quot; value=&quot;https://dotnetfeed.blob.core.windows.net/dotnet-core/index.json&quot; /&gt;
        &lt;add key=&quot;templating&quot; value=&quot;https://dotnet.myget.org/F/templating/api/v3/index.json&quot; /&gt;
        &lt;add key=&quot;aspnet&quot; value=&quot;https://dotnet.myget.org/F/aspnetcore-release/api/v3/index.json&quot; /&gt;
        &lt;add key=&quot;websdkfeed&quot; value=&quot;https://dotnet.myget.org/F/dotnet-web/api/v3/index.json&quot; /&gt;
        &lt;add key=&quot;cli-deps&quot; value=&quot;https://dotnet.myget.org/F/cli-deps/api/v3/index.json&quot; /&gt;
        &lt;add key=&quot;roslyn&quot; value=&quot;https://dotnet.myget.org/f/roslyn/api/v3/index.json&quot; /&gt;
        &lt;add key=&quot;symreader-native&quot; value=&quot;https://dotnet.myget.org/f/symreader-native/api/v3/index.json&quot; /&gt;
        &lt;add key=&quot;xunit&quot; value=&quot;https://www.myget.org/F/xunit/api/v3/index.json&quot; /&gt;
        &lt;add key=&quot;api.nuget.org&quot; value=&quot;https://api.nuget.org/v3/index.json&quot; /&gt;
        &lt;add key=&quot;vstest&quot; value=&quot;https://dotnet.myget.org/F/vstest/api/v3/index.json&quot; /&gt;
        &lt;add key=&quot;web-api&quot; value=&quot;https://dotnet.myget.org/F/dotnet-web/api/v3/index.json&quot; /&gt;
        &lt;add key=&quot;symreader-native&quot; value=&quot;https://dotnet.myget.org/F/symreader-native/api/v3/index.json&quot; /&gt;
        &lt;add key=&quot;AspNetMaster&quot; value=&quot;https://dotnet.myget.org/F/aspnetcore-master/api/v3/index.json" /&gt;
      </NugetConfigFeedsNormal>

      <NugetConfigSuffix>
        &lt;/packageSources&gt;
        &lt;/configuration&gt;
      </NugetConfigSuffix>
    </PropertyGroup>

    <WriteLinesToFile File="$(GeneratedNuGetConfig)"
                      Lines="$(NugetConfigHeader)"
                      Overwrite="true" />
    
    <WriteLinesToFile Condition="'$(ExternalRestoreSources)' != ''"
                      File="$(GeneratedNuGetConfig)"
                      Lines="$(NugetConfigFeedsPrivate)"
                      Overwrite="false" />

    <WriteLinesToFile Condition="'$(DotNetBuildOffline)' != 'true'"
                      File="$(GeneratedNuGetConfig)"
                      Lines="$(NugetConfigFeedsNormal)"
                      Overwrite="false" />

    <WriteLinesToFile File="$(GeneratedNuGetConfig)"
                      Lines="$(NugetConfigSuffix)"
                      Overwrite="false" />

  </Target>
</Project>
